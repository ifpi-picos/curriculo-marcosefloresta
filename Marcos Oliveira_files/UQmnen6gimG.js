if (self.CavalryLogger) { CavalryLogger.start_js(["GDxrg"]); }

__d("ProfileMediaAlwaysPublicIcon.react",["ix","cx","Image.react","ProfilePicCropViewerStrings","React","Tooltip","fbglyph","joinClasses"],(function(a,b,c,d,e,f,g,h){__p&&__p();a=b("React").PropTypes;c=function(a){"use strict";babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.render=function(){return b("React").createElement(b("Image.react"),babelHelpers["extends"]({className:b("joinClasses")(this.props.className,"_1wlw")},b("Tooltip").propsFor(this.props.privacyMessage),{src:this.props.sourceImage}))};return c}(b("React").PureComponent);c.propTypes={privacyMessage:a.string.isRequired,sourceImage:a.object};c.defaultProps={privacyMessage:b("ProfilePicCropViewerStrings").PROFILE_PIC_VISIBILITY,sourceImage:g("124640")};e.exports=c}),null);
__d("PhotoProgressBar.react",["ProgressBar.react","React"],(function(a,b,c,d,e,f){__p&&__p();a=b("React").PropTypes;var g=1,h=50;c=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.state={value:c.props.value},c.$3=function(){c.setState({value:c.state.value+g})},c.$1=function(a){var b=c.props,d=(b.max-b.min)*b.fakeLoadMultplier+b.min;a>=b.max&&a<d&&(window.clearTimeout(c.$2),c.$2=window.setTimeout(c.$3,h));return a/d*b.max},b)||babelHelpers.assertThisInitialized(c)}var d=c.prototype;d.render=function(){var a=this.$1(this.state.value);return b("React").createElement(b("ProgressBar.react"),babelHelpers["extends"]({},this.props,{value:a}))};d.UNSAFE_componentWillReceiveProps=function(a){this.setState({value:a.value})};d.componentWillUnmount=function(){window.clearTimeout(this.$2)};return c}(b("React").Component);c.propTypes={fakeLoadMultplier:a.number};c.defaultProps={fakeLoadMultplier:1.5,min:0,max:100};e.exports=c}),null);
__d("XProfilePicCropViewerAsyncController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/profile/picture/crop_viewer/",{photo_id:{type:"String",required:!0},photo_sizes:{type:"IntVector",defaultValue:[960,2048,4096]},profile_id:{type:"Int",required:!0},set_id:{type:"String",required:!0},sticker_id:{type:"Int"},will_load_more_photos:{type:"Bool",defaultValue:!1},source:{type:"String"}})}),null);
__d("ProfilePhotoZoomCrop.react",["ix","cx","Arbiter","AsyncRequest","AsyncResponse","AsyncUploadRequest","CircularProfilePicGating","Image.react","PhotoEditorTargetType","PhotoZoomCropDimensions","PhotoZoomCropImage.react","PhotoZoomCropMixin","ProfilePhotoSource","ProfilePicCropViewerStrings","React","XProfilePicCropViewerAsyncController","XProfilePicUploadAsyncController","XStickerPhotoEditorController","XUIButton.react","fbglyph","joinClasses","tidyEvent"],(function(a,b,c,d,e,f,g,h){__p&&__p();a=b("React").PropTypes;c=b("React").createClass({displayName:"ProfilePhotoZoomCrop",_photoEditorRequest:null,mixins:[b("PhotoZoomCropMixin")],propTypes:{isPreviousProfilePic:a.bool,messageText:a.string,onMove:a.func,onPhotoChange:a.func,overlay:a.element,photoDims:a.instanceOf(b("PhotoZoomCropDimensions")).isRequired,photoID:a.string,setid:a.string,source:a.string,src:a.oneOfType([a.string,a.object]),warningText:a.string},render:function(){var a=null;!this.props.isPreviousProfilePic&&this.props.source!==b("ProfilePhotoSource").FAMILY_MEMBER&&this.props.source!==b("ProfilePhotoSource").ROOM_PROFILE&&this.props.source!==b("ProfilePhotoSource").CULTURAL_MOMENT_HOLIDAY_CARD&&(a=b("React").createElement(b("XUIButton.react"),{className:"_3-8-",image:b("React").createElement(b("Image.react"),{src:g("142450")}),label:b("ProfilePicCropViewerStrings").BUTTON_EDIT,onClick:this._openEditDialog}));return b("React").createElement("div",{className:b("joinClasses")(this.props.className,"_5z0p"+(this.props.source!==b("ProfilePhotoSource").FAMILY_MEMBER?" _37ml":""))},b("React").createElement(b("PhotoZoomCropImage.react"),{circular:b("CircularProfilePicGating").displayCircularProfilePic,className:"_5z0r",dimensions:this.props.photoDims,enableDrag:this.props.photoDims.isCurrentlyDragable(),onMove:this.props.onMove,overlay:this.props.overlay,src:this.props.src}),this._getMessage(),a)},__getZoom:function(){return this.props.photoDims.getZoom()},_openEditDialog:function(){var a=this;if(this._photoEditorRequest||!this.props.photoID)return;b("Arbiter").subscribe("ProfilePicPhotoEditor/newImage"+this.props.photoID,this._photoEditDone);var c=b("XStickerPhotoEditorController").getURIBuilder().setEnum("target_type",b("PhotoEditorTargetType").PROFILE_PIC).setInt("latest_fbid",this.props.photoID).setInt("photo_fbid",this.props.photoID).getURI();this._photoEditorRequest=new(b("AsyncRequest"))(c).setFinallyHandler(function(){a._photoEditorRequest=null});this._photoEditorRequest.send()},_photoEditDone:function(a,c){__p&&__p();var d=this;a=this.props.onPhotoChange;a&&a();var e=b("XProfilePicUploadAsyncController").getURIBuilder().setInt("profile_id",this.props.profileID).getURI();e=new(b("AsyncUploadRequest"))().setFiles({photo:c.blob}).setAllowCrossOrigin(!0).setURI(e);b("tidyEvent")([e.subscribe("success",function(a,c){a=c.getResponse().getPayload();c=b("XProfilePicCropViewerAsyncController").getURIBuilder().setString("photo_id",a.fbid).setInt("profile_id",d.props.profileID).setString("set_id",d.props.setid).setBool("will_load_more_photos",!0).getURI();new(b("AsyncRequest"))(c).setErrorHandler(function(a){b("AsyncResponse").defaultErrorHandler(a)}).send()})]);e.send();a&&a(c)}});e.exports=c}),null);
__d("ProfilePicCropViewerLoading.react",["cx","React","XUISpinner.react","joinClasses"],(function(a,b,c,d,e,f,g){__p&&__p();a=function(a){"use strict";babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.render=function(){return b("React").createElement("div",{className:b("joinClasses")("_278e",this.props.className)},b("React").createElement(b("XUISpinner.react"),{background:"dark",className:"_4-cf",size:"large"}))};return c}(b("React").Component);e.exports=a}),null);
__d("ProfilePicViewerFooterText.react",["cx","React","XUIGrayText.react"],(function(a,b,c,d,e,f,g){__p&&__p();a=function(a){"use strict";babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.render=function(){return b("React").createElement(b("XUIGrayText.react"),babelHelpers["extends"]({},this.props,{className:"_2pi2",display:"block",shade:"medium",size:"meta1"}),this.props.children)};return c}(b("React").Component);e.exports=a}),null);
__d("ZoomProfilePicCropModes",[],(function(a,b,c,d,e,f){a=Object.freeze({CROP:"CROP",CROP_ONLY:"CROP_ONLY",FRAME:"FRAME",SET_THUMBNAIL:"SET_THUMBNAIL"});e.exports=a}),null);
__d("ProfilePicComposerActionTypes",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({SET_COMPOSER_DATA:"set_composer_data"})}),null);
__d("ProfilePicComposerStore",["FluxStore","ProfilePicComposerActionTypes","ProfilePicComposerDispatcher","getByPath"],(function(a,b,c,d,e,f){__p&&__p();a=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.__onDispatch=function(a){switch(a.type){case b("ProfilePicComposerActionTypes").SET_COMPOSER_DATA:this.$ProfilePicComposerStore1=a.composerData;this.__emitChange();break}};d.getComposerData=function(){return this.$ProfilePicComposerStore1};d.getComposerID=function(){return b("getByPath")(this.$ProfilePicComposerStore1,["config","composerID"])};return c}(b("FluxStore"));a.__moduleID=e.id;e.exports=new a(b("ProfilePicComposerDispatcher"))}),null);
__d("ReactComposerProfilePicEagerAttachment.react",["cx","React","ReactComposerAttachmentBodyMixin","ReactComposerAttachmentType","ReactComposerConfig","ReactComposerContextConfig","ReactComposerContextTypes","ReactComposerStatusActions","ReactComposerStatusAttachmentMentionsInputWithTagExpansionContainer.react"],(function(a,b,c,d,e,f,g){a=b("React").PropTypes;c=b("React").createClass({displayName:"ReactComposerProfilePicEagerAttachment",contextTypes:b("ReactComposerContextTypes"),mixins:[b("ReactComposerAttachmentBodyMixin")()],propTypes:{config:b("ReactComposerConfig").isRequired,contextConfig:b("ReactComposerContextConfig").isRequired,mentionsSource:a.object,placeholder:a.string,selected:a.bool},UNSAFE_componentWillMount:function(){b("ReactComposerStatusActions").setMentionsSource(this.context.composerID,this.props.mentionsSource)},statics:{attachmentID:b("ReactComposerAttachmentType").PROFILE_PIC_DESCRIPTION},renderX:function(){return b("React").createElement("div",{className:"_2i1s"},b("React").createElement(b("ReactComposerStatusAttachmentMentionsInputWithTagExpansionContainer.react"),{config:this.props.config,mentionsSource:this.props.mentionSource,placeholder:this.props.placeholder}))}});e.exports=c}),null);
__d("ReactProfilePicComposer.react",["React","ReactComposer.react","ReactComposerBodyContainer.react","ReactComposerConfig","ReactComposerContextConfig","ReactComposerContextProviderMixin","ReactComposerProfilePicEagerAttachment.react"],(function(a,b,c,d,e,f){a=b("React").PropTypes;c=b("React").createClass({displayName:"ReactProfilePicComposer",mixins:[b("ReactComposerContextProviderMixin")],propTypes:{contextConfig:b("ReactComposerContextConfig").isRequired,config:b("ReactComposerConfig").isRequired,mentionsSource:a.object.isRequired,placeholder:a.string},render:function(){return b("React").createElement(b("ReactComposer.react"),{loggingConfig:this.props.config.loggingConfig},b("React").createElement(b("ReactComposerBodyContainer.react"),null,b("React").createElement(b("ReactComposerProfilePicEagerAttachment.react"),babelHelpers["extends"]({},this.props,{selected:!0}))))}});e.exports=c}),null);
__d("ProfilePicComposerContainer.react",["cx","CenteredContainer.react","FluxContainer","ProfilePicComposerStore","React","ReactProfilePicComposer.react","XUISpinner.react"],(function(a,b,c,d,e,f,g){__p&&__p();a=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}c.getStores=function(){return[b("ProfilePicComposerStore")]};c.calculateState=function(a){return{composerData:b("ProfilePicComposerStore").getComposerData()}};var d=c.prototype;d.render=function(){return this.state.composerData?b("React").createElement(b("ReactProfilePicComposer.react"),babelHelpers["extends"]({},this.state.composerData,{placeholder:this.props.placeholder})):b("React").createElement(b("CenteredContainer.react"),{className:"_24io",vertical:!0},b("React").createElement(b("XUISpinner.react"),null))};return c}(b("React").Component);e.exports=b("FluxContainer").create(a)}),null);
__d("XProfilePicComposerAsyncController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/profile/picture/composer_data/",{profile_id:{type:"FBID",required:!0}})}),null);
__d("ZoomProfilePicCropViewerBody.react",["cx","AsyncRequest","BasicVector","PhotoProgressBar.react","PhotoZoomCropDimensions","ProfilePhotoSource","ProfilePhotoZoomCrop.react","ProfilePicComposerContainer.react","ProfilePicComposerDispatcher","ProfilePicComposerStore","ProfilePicCropViewerLoading.react","ProfilePicCropViewerStrings","ProfilePicOverlay.react","React","SpotlightViewerDimensionMixin","XProfilePicComposerAsyncController"],(function(a,b,c,d,e,f,g){__p&&__p();a=b("React").PropTypes;var h=320;c=b("React").createClass({displayName:"ZoomProfilePicCropViewerBody",_progress:null,mixins:[b("SpotlightViewerDimensionMixin")],propTypes:{height:a.number.isRequired,onPhotoChange:a.func,photoData:a.object,photoDims:a.instanceOf(b("PhotoZoomCropDimensions")),photoID:a.string,profileID:a.string.isRequired,setid:a.string,showSpinner:a.bool.isRequired,source:a.string,uploadRequest:a.object,width:a.number.isRequired},getInitialState:function(){return{height:this.props.height,uploadStatus:null}},UNSAFE_componentWillMount:function(){b("ProfilePicComposerDispatcher").explicitlyRegisterStores([b("ProfilePicComposerStore")]);var a=b("XProfilePicComposerAsyncController").getURIBuilder().setFBID("profile_id",this.props.profileID).getURI();new(b("AsyncRequest"))(a).send()},componentDidMount:function(){this._listenForUploadProgress()},componentDidUpdate:function(){this._listenForUploadProgress()},componentWillUnmount:function(){this._progress&&(this._progress.unsubscribe(),this._progress=null)},render:function(){var a=this.props.photoData,c;this.state.uploadStatus!==null?c=b("React").createElement(b("PhotoProgressBar.react"),{className:"_2aii",isRounded:!0,size:"small",value:this.state.uploadStatus}):(!a||this.props.showSpinner)&&(c=b("React").createElement(b("ProfilePicCropViewerLoading.react"),{className:a?"":"_3mdt"}));return b("React").createElement("div",{className:"_3mds","data-testid":"cropViewerBody",style:{height:this.state.height,width:this.props.width}},this._getImage(),c)},_getImage:function(){__p&&__p();var a=this.props,c=a.photoData;a=a.photoDims;if(!c||!a)return null;if(c.previousprofilepic&&this.props.source!==b("ProfilePhotoSource").CULTURAL_MOMENT_HOLIDAY_CARD)return b("React").createElement(b("ProfilePhotoZoomCrop.react"),babelHelpers["extends"]({},this.props,{className:"_zxy _zy5",isPreviousProfilePic:!0,messageText:b("ProfilePicCropViewerStrings").THUMBNAIL_MODE_EXPLANATION,ref:"image",src:c.original.uri}));a=new(b("BasicVector"))(c.original.width,c.original.height);a=a.x<h||a.y<h?b("ProfilePicCropViewerStrings").SMALL_PHOTO_WARNING:b("ProfilePicCropViewerStrings").ZOOM_WARNING;a=this.props.source!==b("ProfilePhotoSource").CULTURAL_MOMENT_HOLIDAY_CARD?a:"";var d=null;c.overlayData&&(d=b("React").createElement(b("ProfilePicOverlay.react"),{src:c.overlayData.src}));d=b("React").createElement(b("ProfilePhotoZoomCrop.react"),babelHelpers["extends"]({},this.props,{overlay:d,ref:"image",src:c.original.uri,warningText:a}));if(this.props.source!==b("ProfilePhotoSource").FAMILY_MEMBER){this.state.height&&this.setState({height:null});c=this.props.source!==b("ProfilePhotoSource").CULTURAL_MOMENT_HOLIDAY_CARD?b("React").createElement(b("ProfilePicComposerContainer.react"),{placeholder:b("ProfilePicCropViewerStrings").CAPTION_INPUT_PLACEHOLDER}):null;return b("React").createElement("div",null,c,d)}return d},resetDimensions:function(){this.refs.image.resetDimensions()},getDimensionsArea:function(){return this.refs.image.getDimensions().getArea()},hasSpaceToDrag:function(){if(!this.props.photoData)return!1;var a=new(b("BasicVector"))(this.props.photoData.original.width,this.props.photoData.original.height);return!b("PhotoZoomCropDimensions").isSquare(a)},_listenForUploadProgress:function(){var a=this,b=this.props.uploadRequest;b&&b.subscribe&&!this._progress&&(this._progress=b.subscribe("progress",function(b,c){return a.setState({uploadStatus:c.event.loaded/c.event.total*100})}))}});e.exports=c}),null);
__d("ZoomProfilePicCropViewerFooter.react",["BootloadedComponent.react","JSResource","PhotoZoomCropDimensions","ProfilePicViewerFooterText.react","React","XUIDialogFooter.react"],(function(a,b,c,d,e,f){__p&&__p();a=b("React").PropTypes;c=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.render=function(){var a=this.props.children,c=null,d=null;b("React").Children.count(a)===1?c=a:Array.isArray(a)&&(c=a[0],d=a[1]);return b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("ProfilePicViewerUMGFooter.react").__setRef("ZoomProfilePicCropViewerFooter.react"),bootloadPlaceholder:b("React").createElement(b("XUIDialogFooter.react"),{fullBleedBorder:!0},b("React").createElement(b("ProfilePicViewerFooterText.react"),null,"\xa0")),hideSlider:this.props.hideZoomSlider,onZoom:this.props.onZoom,photoDims:this.props.photoDims,zoomSliderPosition:this.props.zoomSliderPosition},c,d)};return c}(b("React").Component);c.propTypes={children:function(a,c){if(b("React").Children.count(a[c])>2)return new Error("ZoomProfilePicCropViewerFooter must have 2 or fewer children")},hideZoomSlider:a.bool,onZoom:a.func,photoDims:a.instanceOf(b("PhotoZoomCropDimensions")),zoomSliderPosition:a.number};e.exports=c}),null);
__d("ZoomProfilePicCropViewerFooterButtons.react",["ProfilePhotoSource","ProfilePicCropViewerStrings","ProfilePicViewerFooterText.react","React","XUIButton.react"],(function(a,b,c,d,e,f){__p&&__p();a=b("React").PropTypes;c=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.render=function(){__p&&__p();if(this.props.savingMode&&this.props.source!==b("ProfilePhotoSource").CULTURAL_MOMENT_HOLIDAY_CARD)return b("React").createElement(b("ProfilePicViewerFooterText.react"),{weight:"bold"},b("ProfilePicCropViewerStrings").CROP_SAVING);if(this.props.uploadRequest)return b("React").createElement(b("XUIButton.react"),{label:b("ProfilePicCropViewerStrings").BUTTON_CANCEL,onClick:this.props.onUploadCancel});if(this.props.hasPhoto){var a=!1;this.props.savingMode&&this.props.source===b("ProfilePhotoSource").CULTURAL_MOMENT_HOLIDAY_CARD&&(a=!0);return b("React").createElement("div",null,this.props.privacyIcon,b("React").createElement(b("XUIButton.react"),{disabled:a,label:b("ProfilePicCropViewerStrings").BUTTON_CANCEL,onClick:this.props.onCancel}),b("React").createElement(b("XUIButton.react"),{"data-testid":"profilePicSaveButton",disabled:a,label:this.props.saveButtonLabel,onClick:this.props.onSaveClick,use:"confirm"}))}return b("React").createElement(b("ProfilePicViewerFooterText.react"),null,"\xa0")};return c}(b("React").PureComponent);c.propTypes={hasPhoto:a.bool,onCancel:a.func,onSaveClick:a.func,onUploadCancel:a.func,privacyIcon:a.element,saveButtonLabel:a.oneOfType([a.string,a.object]),savingMode:a.bool,source:a.string,uploadRequest:a.object};e.exports=c}),null);
__d("ZoomProfilePicCropViewerFooterLeftContent.react",["ix","cx","Image.react","LeftRight.react","Link.react","ProfilePicCropViewerStrings","ProfilePicViewerFooterText.react","React","XUIButton.react","ZoomProfilePicCropModes","fbglyph"],(function(a,b,c,d,e,f,g,h){__p&&__p();a=b("React").PropTypes;c=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.render=function(){__p&&__p();var a=this.props.photoData;if(!a||this.props.uploadRequest||this.props.cropMode===b("ZoomProfilePicCropModes").CROP_ONLY)return b("React").createElement(b("ProfilePicViewerFooterText.react"),null,"\xa0");if(a.previousprofilepic)return b("React").createElement(b("ProfilePicViewerFooterText.react"),null,b("ProfilePicCropViewerStrings").PREV_PHOTO_ADJUST_THUMBNAIL);if(this.props.isSaving||a.stickerData)return b("React").createElement(b("ProfilePicViewerFooterText.react"),null,"\xa0");var c,d,e=this.props.cropMode===b("ZoomProfilePicCropModes").FRAME;e?(c=b("ProfilePicCropViewerStrings").CROP_AND_SAVE,d=b("ProfilePicCropViewerStrings").FRAME_PREVENTS_CROP):this.props.cropMode===b("ZoomProfilePicCropModes").CROP?(c=b("ProfilePicCropViewerStrings").SKIP_CROP,d=b("ProfilePicCropViewerStrings").SKIP_CROP_EXPLANATION):(c=b("ProfilePicCropViewerStrings").CROP_AND_SAVE,d=b("ProfilePicCropViewerStrings").CROP_EXPLANATION);var f=this.props.onModeChange,h=null;a.hasExistingProfilePic&&(h=b("React").createElement(b("XUIButton.react"),{className:"_4vsj _3-8j _3-99",depressed:this.props.makeTemporaryButtonDepressed,image:b("React").createElement(b("Image.react"),{src:g("141869")}),label:b("ProfilePicCropViewerStrings").BUTTON_MAKE_TEMPORARY,onClick:this.props.onExpiringControlClick}));return b("React").createElement("div",null,b("React").createElement(b("LeftRight.react"),{className:"_4vsi _2pis"},h,b("React").createElement("div",{className:"_3-99 _2pi4"},b("React").createElement(b("ProfilePicViewerFooterText.react"),null,b("React").createElement(b("Link.react"),{"aria-label":d,className:"_4vsh"+(e?" _5vll":""),"data-hover":"tooltip",onClick:function(){return!e&&f&&f()}},c)))))};return c}(b("React").PureComponent);c.propTypes={cropMode:a.oneOf(Object.keys(b("ZoomProfilePicCropModes"))),isSaving:a.bool,makeTemporaryButtonDepressed:a.bool,onExpiringControlClick:a.func,onModeChange:a.func,photoData:a.object,uploadRequest:a.object};e.exports=c}),null);
__d("ZoomProfilePicCropViewer.react",["cx","fbt","ix","ArbiterMixin","DateConsts","PhotoZoomCropDimensions","ProfileMediaAlwaysPublicIcon.react","ProfilePhotoSource","ProfilePicComposerStore","ProfilePicCropViewerMixin","ProfilePicCropViewerStrings","ProfilePicExpirationSelector.react","ProfilePictureFlowLogging","React","ReactComposerStatusStore","SpotlightViewerCoreMixin","SpotlightViewerDimensionMixin","XUIDialog.react","XUIDialogTitle.react","XUIGrayText.react","ZoomProfilePicCropModes","ZoomProfilePicCropViewerBody.react","ZoomProfilePicCropViewerFooter.react","ZoomProfilePicCropViewerFooterButtons.react","ZoomProfilePicCropViewerFooterLeftContent.react"],(function(a,b,c,d,e,f,g,h,i){__p&&__p();a=b("React").PropTypes;var j=484,k=775;c=b("React").createClass({displayName:"ZoomProfilePicCropViewer",__shouldPreventPhotoPreload:!0,_hasFrame:!1,mixins:[b("ArbiterMixin"),b("ProfilePicCropViewerMixin"),b("SpotlightViewerCoreMixin"),b("SpotlightViewerDimensionMixin")],propTypes:{cancelCallback:a.func,cropControllerURIBuilder:a.object,cropMode:a.oneOf(Object.keys(b("ZoomProfilePicCropModes"))),errorCallback:a.func,photoID:a.string,profileID:a.string.isRequired,setid:a.string.isRequired,source:a.string,successCallback:a.func,uploadRequest:a.object,warnOnCancel:a.bool},getInitialState:function(){return{expirationTime:null,frameData:null,cropMode:this.props.cropMode||b("ZoomProfilePicCropModes").CROP,open:!0,photoData:null,photoDims:null,savingMode:!1,showExpirationControls:!1,showLoading:!1,zoomSliderPosition:null}},componentDidMount:function(){var a=this;this.subscribe("photo_change",function(){var c=null;a._hasFrame&&(c={center:{x:.5,y:.5},size:{x:1,y:1}});c=b("PhotoZoomCropDimensions").fromProfilePhotoData(a.state.photoData,c);a.setState({photoDims:c,showLoading:!1,zoomSliderPosition:c.getZoom()})})},render:function(){var a=this,c=null;this.state.showExpirationControls&&(c=b("React").createElement("div",{className:"_1zst"},b("React").createElement(b("ProfilePicExpirationSelector.react"),{defaultValue:this.state.expirationTime,onChange:function(b){return a.setState({expirationTime:b})},showCustomOption:!0})));var d=this.state,e=d.photoData;d=d.photoDims;var f;this.props.source===b("ProfilePhotoSource").FAMILY_MEMBER?f=b("React").createElement(b("ProfileMediaAlwaysPublicIcon.react"),{privacyMessage:h._("Esta foto est\u00e1 vis\u00edvel a qualquer pessoa que possa ver pelo menos uma foto neste scrapbook."),sourceImage:i("83912")}):e&&!e.isWorkUser?f=b("React").createElement(b("ProfileMediaAlwaysPublicIcon.react"),null):f=null;return b("React").createElement(b("XUIDialog.react"),{"data-testid":"profile_pic_crop_dialog",layerHideOnBlur:!1,modal:!0,shown:!0,width:k},b("React").createElement(b("XUIDialogTitle.react"),{showCloseButton:!1},b("React").createElement(b("XUIGrayText.react"),{display:"block",shade:"medium",size:"header4",weight:"bold"},this._getTitle())),b("React").createElement(b("ZoomProfilePicCropViewerBody.react"),{height:j,messageText:this.state.cropMode===b("ZoomProfilePicCropModes").SET_THUMBNAIL?b("ProfilePicCropViewerStrings").THUMBNAIL_MODE_EXPLANATION:null,onMove:this._handleMove,onPhotoChange:this._handlePhotoChange,photoData:e,photoDims:d,photoID:this.props.photoID,profileID:this.props.profileID,ref:"zoomBody",setid:this.props.setid,showSpinner:this.state.savingMode||this.state.showLoading,source:this.props.source,uploadRequest:this.props.uploadRequest,width:k}),c,b("React").createElement(b("ZoomProfilePicCropViewerFooter.react"),{hideZoomSlider:this.state.cropMode===b("ZoomProfilePicCropModes").FRAME||this.state.savingMode,onZoom:this._handleZoom,photoDims:d,zoomSliderPosition:this.state.zoomSliderPosition},b("React").createElement(b("ZoomProfilePicCropViewerFooterLeftContent.react"),{cropMode:this.state.cropMode,isSaving:this.state.savingMode,makeTemporaryButtonDepressed:this.state.showExpirationControls,onExpiringControlClick:this.handleExpiringControlClick,onModeChange:this.handleModeChange,photoData:e,uploadRequest:this.props.uploadRequest}),b("React").createElement(b("ZoomProfilePicCropViewerFooterButtons.react"),{hasPhoto:!!e,onCancel:this.handleCancel,onSaveClick:this.handleSaveClick,onUploadCancel:this.handleUploadCancel,privacyIcon:f,saveButtonLabel:this._getSaveButtonLabel(),savingMode:this.state.savingMode,uploadRequest:this.props.uploadRequest})))},_getTitle:function(){var a=this.state.photoData;if(this.props.uploadRequest)return b("ProfilePicCropViewerStrings").UPLOADING;else if(!a)return b("ProfilePicCropViewerStrings").LOADING;else if(a.previousprofilepic)return b("ProfilePicCropViewerStrings").SET_THUMBNAIL;return b("ProfilePicCropViewerStrings").UMG_TITLE},_handlePhotoChange:function(a){this.setState({showLoading:!0}),a&&(this.viewState.forward(),this.setState({frameData:a.frameData}),this._hasFrame=!!a.frameData,this._hasFrame&&this.setState({cropMode:b("ZoomProfilePicCropModes").FRAME}))},_handleZoom:function(a,b){a=this.state.photoDims.cloneAndZoom(a[0]);this.setState({photoDims:a,zoomSliderPosition:b||a.getZoom()})},handleModeChange:function(){var a=this._isCropMode()?b("ZoomProfilePicCropModes").SET_THUMBNAIL:b("ZoomProfilePicCropModes").CROP;this.setState({cropMode:a})},handleSaveClick:function(){__p&&__p();if(this.state.cropMode===b("ZoomProfilePicCropModes").FRAME){this.handleCropSave();return}if(this.state.photoData&&this.state.photoData.previousprofilepic){this.handlePositionSave();return}if(this._isCropMode()){this.handleCropSave();return}this.handleSetThumbnailSave()},handleExpiringControlClick:function(){var a=!this.state.showExpirationControls,c=null;a&&(c=b("DateConsts").SEC_PER_DAY);this.setState({showExpirationControls:a,expirationTime:c})},_handleMove:function(a,b){this.setState({photoDims:this.state.photoDims.cloneAndMove(a,b)})},_getSaveButtonLabel:function(){return b("ProfilePicCropViewerStrings").BUTTON_SAVE},_isCropMode:function(){return this.state.cropMode===b("ZoomProfilePicCropModes").CROP},getCropArea:function(){return this.state.photoDims.getArea()},getFlowType:function(){return b("ProfilePictureFlowLogging").flow.ZOOMCROP},getPhotoSize:function(){return this.state.photoData.original},getCaption:function(){var a=b("ProfilePicComposerStore").getComposerID();return a?b("ReactComposerStatusStore").getMessage(a):""},getOverlayData:function(){return this.state.frameData},getOverlaySourceObjectID:function(){return null},getPaymentID:function(){return null},getViewerID:function(){return this.props.setid}});e.exports=c}),null);