if (self.CavalryLogger) { CavalryLogger.start_js(["WMZ+4"]); }

__d("SendAPIDialogButton",["Button"],(function(a,b,c,d,e,f){e.exports={monitor:function(a){var c=document.getElementsByName("publish")[0],d="TypeaheadBehaviors";Object.assign(window[d]||(window[d]={}),{SendAPIDialogButtonActivate:function(d){d.subscribe("select",function(){b("Button").setEnabled(c,1)}),d.subscribe("blur",function(){var d=a.getTokenValues();b("Button").setEnabled(c,d&&d.length)})}})}}}),null);
__d("LitestandLinkHider",["DataStore","DOMQuery","Event","Parent","UserAgent_DEPRECATED"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function g(a){var c=a.getTarget();c=b("Parent").byTag(c,"a");if(!(c instanceof HTMLAnchorElement))return;a.type==="mouseover"?(b("DataStore").set(c,"href",c.href),c.removeAttribute("href")):(c.href=b("DataStore").get(c,"href")||c.href,a.type==="mouseout"&&b("DataStore").remove(c,"href"))}var h={hideLinks:function(a){(b("UserAgent_DEPRECATED").chrome()||b("UserAgent_DEPRECATED").ie()>=9||b("UserAgent_DEPRECATED").opera())&&b("Event").listen(a,{mouseover:g,mouseout:g,mousedown:g})},removeAllHrefs:function(a,c){__p&&__p();c===void 0&&(c=null);a=b("DOMQuery").scry(a,"a");a.forEach(function(a){if(Array.isArray(c)&&a.classList&&a.classList instanceof DOMTokenList&&c.some(function(b){return Array.from(a.classList.values()).indexOf(b)!==-1}))return;a.removeAttribute("href");a.removeAttribute("ajaxify");a.removeAttribute("rel");a.setAttribute("tabindex",0)})},removeClickable:function(a,c,d){h.removeAllHrefs(a,d);d=b("DOMQuery").scry(a,"."+c+" a");d.forEach(function(a){a.removeAttribute("onclick"),a.removeAttribute("onmouseover")})}};e.exports=h}),null);
__d("XFamilyBulkTagAddAsyncController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/family/bulk_tag_save/",{subject:{type:"Int"},save_tags:{type:"String"}})}),null);
__d("PhotoTagStore",["ActorURI","AsyncRequest","XFamilyBulkTagAddAsyncController","isEmpty"],(function(a,b,c,d,e,f){__p&&__p();a=function(){"use strict";__p&&__p();function a(){this._tagList={},this._textTagList={},this._originalTagList={},this._dirtyPhotosByUid={},a.instance=this}var c=a.prototype;c.getPhotoTags=function(a){return this._tagList[a]||{}};c.photoHasTags=function(a){return!b("isEmpty")(this.getPhotoTags(a))};c.clear=function(){this._tagList={},this._textTagList={},this._originalTagList={},this._dirtyPhotosByUid={}};c.addTag=function(a,b,c,d){a[b]=a[b]||{};var e=a[b][c]||[];e.push(d);a[b][c]=e};c.revert=function(a){var c=this._tagList,d=this._originalTagList;for(var e in c)b("isEmpty")(d[e][a])?c[e][a]=[]:c[e][a]=d[e][a];this._dirtyPhotosByUid={}};c.hasNewTags=function(){return!b("isEmpty")(this._tagList)||!b("isEmpty")(this._textTagList)};c.userHasDirtyTags=function(a){return!b("isEmpty")(this._dirtyPhotosByUid[a])};c.userDirtyTagsCount=function(a){return Object.keys(this._dirtyPhotosByUid[a]).length};c.handleTagFetch=function(a){for(var b in a)this.loadTagInfo(b,a[b])};c.saveAlbumTagsForUser=function(a,c,d,e){__p&&__p();e===void 0&&(e=!1);var f={},g=[],h=this._dirtyPhotosByUid[a]||{};for(var i in h){h=this._tagList[i][a];if(b("isEmpty")(h)){g[g.length]=i;continue}h.forEach(function(a){f[i]={x:a.x,y:a.y}})}h={subject:a,action:"save",save_tags:f};g=b("ActorURI").create("/ajax/photos/album/tags.php",c);e&&(h={subject:a,save_tags:JSON.stringify(f)},g=b("XFamilyBulkTagAddAsyncController").getURIBuilder().getURI());new(b("AsyncRequest"))().setURI(g).setData(h).setHandler(function(a){d(a.payload)}).setAllowCrossPageTransition(!0).send();delete this._dirtyPhotosByUid[a]};c.getTagsFromList=function(a){var b=[];for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c))for(var d in a[c])Object.prototype.hasOwnProperty.call(a[c],d)&&a[c][d].forEach(function(a){return b.push(a)});return b};c.getAllTags=function(){var a=this.getTagsFromList(this._tagList),b=this.getTagsFromList(this._textTagList);return a.concat(b)};c.removeTag=function(a,c){var d=this._tagList[a],e=this._originalTagList[a]||{};e[c]?(this._dirtyPhotosByUid[c]=this._dirtyPhotosByUid[c]||{},this._dirtyPhotosByUid[c][a]=!0):delete this._dirtyPhotosByUid[c][a];for(var f in d)if(f==c){e=this._tagList[a][f];delete this._tagList[a][f];b("isEmpty")(this._tagList[a])&&delete this._tagList[a];return e}};c.removeTextTag=function(a,c){var d=this._textTagList[a];if(!b("isEmpty")(d[c])){d=this._textTagList[a][c];this._textTagList[a][c]=[];b("isEmpty")(this._textTagList[a])&&delete this._textTagList[a];return d}return[]};c.removeAllNewTagsOfUser=function(a){var b=[];if(!this.userHasDirtyTags(a))return b;var c=this._dirtyPhotosByUid[a];for(var d in c)b=b.concat(this.removeTag(d,a));return b};c.removeAllTagsFromPhoto=function(a){__p&&__p();var c=[];if(!b("isEmpty")(this._tagList[a]))for(var d in this._tagList[a]){if(!Object.prototype.hasOwnProperty.call(this._tagList[a],d))continue;c=c.concat(this.removeTag(a,d))}if(!b("isEmpty")(this._textTagList[a]))for(var e in this._textTagList[a]){if(!Object.prototype.hasOwnProperty.call(this._textTagList[a],e))continue;c=c.concat(this.removeTextTag(a,e))}return c};c.storeTag=function(a,b,c,d,e){this.storeTagWithOptions(a,b,c,d,{can_remove:e})};c.storeTagWithOptions=function(a,b,c,d,e){this._dirtyPhotosByUid[b]=this._dirtyPhotosByUid[b]||{};this._dirtyPhotosByUid[b][a]=!0;c={x:c,y:d};Object.assign(c,e);!b?this.addTag(this._textTagList,a,c.name,c):this.addTag(this._tagList,a,b,c)};c.loadTagInfo=function(a,b){this._tagList[a]={};this._originalTagList[a]={};for(var c=0;c<b.length;c++){var d=b[c];this.addTag(this._tagList,a,d.subject,d);this.addTag(this._originalTagList,a,d.subject,d)}};a.getInstance=function(){a.instance===null&&new a();return a.instance};return a}();a.instance=null;e.exports=a}),null);
__d("TagTypeaheadView",["AsyncRequest","ContextualTypeaheadView","CSS","DOM","FamilyTaggingConfig","Parent"],(function(a,b,c,d,e,f){__p&&__p();a=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(b,c){b=a.call(this,b,c)||this;b.hintText=c.hintText;b.userEd=c.userEd;b.origAutoSelect=c.autoSelect;b.setSuggestions(c.suggestions);return b}var d=c.prototype;d.init=function(){b("CSS").addClass(this.element,"uiTagTypeaheadView"),a.prototype.init.call(this)};d.buildResults=function(c){__p&&__p();!this.value&&this.hintText&&c.unshift({subtext:this.hintText,type:"hintText"});this.userEd&&(new(b("AsyncRequest"))().setURI("/ajax/fof/user_education.php").setData({increment:1}).send(),c.unshift({subtext:this.userEd,type:"userEdText"}));if(b("FamilyTaggingConfig").gk){var d=[],e=[];for(var f=0;f<c.length;f++)c[f].type!=="family_tags"&&c[f].index!=-1e3&&c[f].type!=="hintText"?d.push(c[f]):e.push(c[f]);c=e.concat(d);a.prototype.updateResults.call(this,c)}f=a.prototype.buildResults.call(this,c);this.userEd&&c.shift();this.value||c.shift();return f};d.show=function(){var c=b("DOM").scry(this.context,".typeaheadBackdrop");c.length>0&&b("CSS").addClass(c[0],"resultsPresent");return a.prototype.show.call(this)};d.hide=function(){var c=b("DOM").scry(this.context,".typeaheadBackdrop");c.length>0&&b("CSS").removeClass(c[0],"resultsPresent");return a.prototype.hide.call(this)};d.render=function(b,c,d){this.autoSelect=this.origAutoSelect&&b.length,this.disableAutoSelect=b.length===0,c=c.concat(this.getAdditionalResults()),a.prototype.render.call(this,b,c,d)};d.getItems=function(){var b=a.prototype.getItems.call(this);this.value||b.shift();this.userEd&&b.shift();return b};d.getSuggestions=function(){return this.suggestions};d.setSuggestions=function(a){this.suggestions=a?a.map(String):[],this.visible=!!this.suggestions.length};d.addSuggestion=function(a){this.suggestions.unshift(a)};d.addTypeaheadFlip=function(a){b("CSS").addClass(this.element,a)};d.removeTypeaheadFlip=function(a){b("CSS").removeClass(this.element,a)};d.getContext=function(){var c=b("Parent").byClass(this.element,"typeaheadContainer");if(c)return c;else return a.prototype.getContext.call(this)};d.getAdditionalResults=function(){return[]};return c}(b("ContextualTypeaheadView"));e.exports=a}),null);
__d("NoTrucatingCompactTypeaheadRenderer",["CompactTypeaheadRenderer"],(function(a,b,c,d,e,f){function a(a,c){return b("CompactTypeaheadRenderer")(a,c)}a.className="noTrucating compact";e.exports=a}),null);
__d("DisablePlatformButton",["CSS","Event","ge"],(function(a,b,c,d,e,f){__p&&__p();var g=!1;a={init:function(a){__p&&__p();for(var c=0;c<a.length;c++){var d=b("ge")(a[c]);b("Event").listen(d,"click",function(c){if(g)return!1;else{g=!0;for(var c=0;c<a.length;c++)b("CSS").addClass(a[c],"uiButtonDisabled")}})}}};e.exports=a}),null);
__d("legacy:AudienceSelector",["AudienceSelector"],(function(a,b,c,d,e,f){b("AudienceSelector")}),3);
__d("FriendListPrivacyOptions",["Arbiter","AsyncDialog","AsyncRequest","DOMQuery","PageTransitions","Parent","SelectorDeprecated","$","ge","nullthrows"],(function(a,b,c,d,e,f){__p&&__p();var g=!1,h=!1,i=null,j={},k=function(a){__p&&__p();Object.keys(j).length||b("PageTransitions").registerHandler(function(){j={},g=!1,h=!1});var c=a.getAttribute("data-name");j[c]=a;b("SelectorDeprecated").listen(a,"select",function(a){a=a.option;var c=b("DOMQuery").find(a,"a.itemAnchor"),d=c.getAttribute("data-flid");if(!d)return;c=c.getAttribute("data-dynamic");c&&g?l.showSmartListNux(a,d):!c&&h&&l.showDumbListNux([d])})},l={listen:function(a,c,d){a=b("ge")(a);if(!a)return;a=b("Parent").byClass(a,"audienceSelector");a&&(k(a),g=c,h=d)},showSmartListNux:function(a,c){a=b("$")(a);new(b("AsyncRequest"))("/ajax/friends/lists/smart_list_publish_nux.php").setData({option_id:a.id,flid:c}).send();g=!1},setContextualDialog:function(a,c){__p&&__p();c=b("$")(c);c=b("Parent").byClass(c,"audienceSelector");if(c){a.setContext(c);a.show();var d=b("Arbiter").subscribe("composer/publish",function(){a.hide()});a.subscribe("hide",function(){d.unsubscribe()})}},showDumbListNux:function(a){b("AsyncDialog").send(new(b("AsyncRequest"))("/ajax/friends/lists/dumb_list_publish_nux.php").setData({flids:a})),h=!1},showBothListsNux:function(a,c){i=b("$")(a),l.showDumbListNux(c)},setDialogX:function(a){if(!i)return;a.subscribe("hide",function(){l.showSmartListNux(b("nullthrows")(i)),i=null})}};e.exports=l}),null);
__d("FreeformTokenizerBehavior",["Event","Input","Keys"],(function(a,b,c,d,e,f){__p&&__p();function a(a,c){__p&&__p();var d=c.matcher&&new RegExp(c.matcher,"i"),e=c.splitter&&new RegExp(c.splitter),f=c.tokenize_on_blur!==!1,g=c.tokenize_on_paste!==!1,h=c.split_on_check===!0,i=c.select_on_comma!==!1,j=c.select_on_space===!0,k=c.never_submit===!0;function l(c){__p&&__p();var f=b("Input").getValue(a.getInput()).trim();e&&c&&c.type=="paste"?f=f.split(e):e&&h?f=f.split(e):f=[f];var g=!1;for(var i=0;i<f.length;i++){var j=f[i].trim();if(j&&(!d||d.test(j))){j={uid:j,text:j,freeform:!0};a.addToken(a.createToken(j));g=!0}}c&&g&&(a.getTypeahead().getCore().afterSelect(),c.kill())}a.subscribe("keydown",function(c,d){c=d.event;d=b("Event").getKeyCode(c);if(d==b("Keys").RETURN||i&&d==b("Keys").COMMA||j&&d==b("Keys").SPACE){var e=a.getTypeahead().getView();e.getSelection()?(e.select(),c.kill()):l(c)}d==b("Keys").RETURN&&k&&c.kill()});a.subscribe("paste",function(a,b){g&&setTimeout(l.bind(null,b.event),20)});a.subscribe("blur",function(b,c){f&&l(),a.getTypeahead().getCore().reset()})}e.exports=a}),null);
__d("TypeaheadHintText",["emptyFunction"],(function(a,b,c,d,e,f){__p&&__p();a=function(){"use strict";function a(a){this._typeahead=a}var b=a.prototype;b.enable=function(){this._typeahead.getCore().resetOnKeyup=!1};return a}();Object.assign(a.prototype,{disable:b("emptyFunction")});e.exports=a}),null);
__d("legacy:HintTextTypeaheadBehavior",["TypeaheadHintText"],(function(a,b,c,d,e,f){a.TypeaheadBehaviors||(a.TypeaheadBehaviors={}),a.TypeaheadBehaviors.hintText=function(a){a.enableBehavior(b("TypeaheadHintText"))}}),3);