if (self.CavalryLogger) { CavalryLogger.start_js(["F82o7"]); }

__d("SLUtils",["csx","Arbiter","DOM","Event","FeedAdsClickLogger","LitestandMessages","LitestandStream","Run","SLConfig","SLPerfTypedLogger","URI","clearTimeout","curry","cxodecode","gkx","goURI","joinClasses","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("gkx")("677764"),i=!1,j=[];function a(a,c){__p&&__p();if(i)return;i=!0;if(!b("SLConfig").gk.s_link_utils)return;z()&&(A().setEvent("init").log(),C("init_timer"));k();b("SLConfig").gk.sl_replace_about_link&&!h&&p(function(a,b){return q(a,b)});if(b("SLConfig").gk.sl_replace_s){w(a);var d=c.map(function(a){return{nonce:b("cxodecode")(a.nonce),className:b("cxodecode")(a.className)}});p(function(a,c){d.forEach(function(c){var d=b("DOM").scry(a,c.nonce);d.forEach(function(a){while(a.firstChild)a.removeChild(a.firstChild);a.className=b("joinClasses")(a.className,c.className)})})})}m();z()&&A().setEvent("init_duration").setDurationMs(D("init_timer")).log()}function k(){b("Arbiter").subscribe(b("LitestandMessages").STORIES_INSERTED,m),b("Arbiter").subscribe("FeedAdsClickLogger/refreshTrackingData",m,"new")}function c(){z()&&C("cleanup_timer"),j.forEach(function(a){a.unsubscribe()}),i=!1,j=[],z()&&A().setEvent("cleanup_duration").setDurationMs(D("cleanup_timer")).log()}var l=null;function m(){__p&&__p();z()&&C("hsa_timer");b("clearTimeout")(l);l=null;var a=[],c=t(),d=y(),e=!1;d.forEach(function(b){__p&&__p();if(!b.id)return;if(c.has(b.id))return;if(!v(b,b.id)){e=!0;return}c.add(b.id);a.push([b,b.id])});e&&(l=b("setTimeoutAcrossTransitions")(m,b("SLConfig").sv.sl_content_waiting_delay),z()&&A().setEvent("hsa_waiting_for_content").log());z()&&A().setEvent("hsa_stories_added").setCount(a.length).log();if(a.length===0)return;a.forEach(function(a){var b=a[0],c=a[1];return o().forEach(function(a){return a(b,c)})});z()&&A().setEvent("hsa_duration").setDurationMs(D("hsa_timer")).log()}var n=[];function o(){return n}function p(a){n.push(a)}function q(a,c){__p&&__p();a=v(a,c);if(!a){z()&&A().setEvent("usl_real_subtitle_missing").log();return}c=b("DOM").scry(a,"a");a=c.filter(function(a){a=new(b("URI"))(a.href).getPath();return a==="/ads/about"||a==="/about/ads"});z()&&A().setEvent("usl_links_updated").setCount(a.length).log();a.forEach(function(a){var c=b("FeedAdsClickLogger").buildURL(a);b("Event").listen(a,"click",b("curry")(r,c));a.href="#"})}function d(a){b("Event").listen(a.link,"click",b("curry")(r,new(b("URI"))("/ads/about")))}function f(a){return}function r(a,c){b("goURI")(a),b("Event").stop(c)}var s=new Set();function t(){return s}var u=new Map();new Map();function v(a,c){var d=null;u.has(c)?d=u.get(c):d=a;c=b("DOM").scry(d,"._5pcp");if(c.length===0)return null;else return c[0]}function w(a){var c=document.createElement("style");c.type="text/css";c.textContent=b("cxodecode")(a);document.getElementsByTagName("head")[0].appendChild(c)}function x(){return b("LitestandStream").getStreamRoot()||document.body}function y(){return b("DOM").scry(x(),"._5pat")}function z(){return!!b("SLConfig").gk.sl_perf_logging}function A(){return new(b("SLPerfTypedLogger"))()}var B=new Map();function C(a){B.set(a,Date.now())}function D(a){a=B.get(a);return a==null?-1:Date.now()-a}b("Run").onBeforeUnload(c);g={init:a,openLink:f,openLabelLink:d};e.exports=g}),null);